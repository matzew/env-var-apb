FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IGVudi12YXIKZGVzY3JpcHRpb246IEVudmlyb25tZW50IFZhcmlh\
YmxlIE9wZXJhdG9yCmJpbmRhYmxlOiBGYWxzZQphc3luYzogb3B0aW9uYWwKbWV0YWRhdGE6CiAg\
ZGlzcGxheU5hbWU6IEVudmlyb25tZW50IFZhcmlhYmxlIE9wZXJhdG9yCiAgbG9uZ0Rlc2NyaXB0\
aW9uOiAiS2VlcCB0aGUgcGF5bG9hZCBvZiBDb25maWdNYXBzIHN5bmNyb25pc2VkIHdpdGggY29u\
dGFpbmVyIEVudmlyb25tZW50IFZhcmlhYmxlcyIKICBpbWFnZVVybDogImh0dHBzOi8vYXZhdGFy\
czIuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3UvMzIwNzY4Mjg/cz0yMDAmdj00IgogIHByb3ZpZGVy\
RGlzcGxheU5hbWU6ICJSZWQgSGF0LCBJbmMuIgpwbGFuczoKICAtIG5hbWU6IGRlZmF1bHQKICAg\
IGRlc2NyaXB0aW9uOiBUaGlzIGRlZmF1bHQgcGxhbiBkZXBsb3lzIHRoZSBlbnZpcm9tZW50IHZh\
cmlhYmxlIG9wZXJhdG9yCiAgICBmcmVlOiBUcnVlCiAgICBtZXRhZGF0YToge30KICAgIHBhcmFt\
ZXRlcnM6CiAgICAtIG5hbWU6IGFkbWluX3VzZXIKICAgICAgdGl0bGU6IE9wZW5zaGlmdCBBZG1p\
biBVc2VyCiAgICAgIHR5cGU6IHN0cmluZwogICAgICByZXF1aXJlZDogdHJ1ZQogICAgLSBuYW1l\
OiBhZG1pbl9wYXNzd29yZAogICAgICB0aXRsZTogT3BlbnNoaWZ0IEFkbWluIFBhc3N3b3JkCiAg\
ICAgIHR5cGU6IHN0cmluZwogICAgICBkaXNwbGF5X3R5cGU6IHBhc3N3b3JkCiAgICAgIHJlcXVp\
cmVkOiB0cnVlCg=="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
